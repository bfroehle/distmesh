<HTML>
<HEAD>
<TITLE>DistMesh - A Simple Mesh Generator in MATLAB</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="distmesh.css" />
</HEAD>

<BODY>

<table width="100%">
<tr>
<td>

<H2>DistMesh - A Simple Mesh Generator in MATLAB</H2>

<H3>News (Mar 11, 2012)</H3>

I have not been maintaining/updating the distmesh code since I wrote it, but
by popular request I have now posted a new version. The main differences and
new features are:
  <ul>
    <li>New 3-D surface mesh generator distmeshsurface.m, type "help distmeshsurface" to see some examples.</li>
    <li>Support for general implicit functions in distmesh2d and distmeshsurface. This means e.g. that an ellipse can be represented by the simple expression phi(x,y)=(x/a)^2+(y/b)^2-1, even if this is not a signed distance function.
    <li>Robustness improvements in distmesh2d, including removal of duplicated fix points, density control, and a final mesh cleanup.</li>
    <li>Recompiled C-functions for 32/64-bit Windows, 64-bit Mac OS X, and 64-bit linux.</li>
    <li>More examples and more consistent size functions in the examples, including a NACA0012 airfoil mesh. Type "help distmesh2d", run the demo "meshdemo2d", or just look at the examples further down on this page.
  </ul>

<H3>Description</H3>

<p>
DistMesh is a simple MATLAB code for generation of unstructured
triangular and tetrahedral meshes. It was developed by <a
href="http://persson.berkeley.edu">Per-Olof Persson</a> (now
at <a href="http://www.berkeley.edu">UC Berkeley</a>) and <a
href="http://www-math.mit.edu/~gs">Gilbert Strang</a> in the <a
href="http://www-math.mit.edu">Department of Mathematics</a> at <a
href="http://www.mit.edu">MIT</a>. A detailed description of the
program is provided in our SIAM Review paper, see documentation below.
</p>

<p>
One reason that the code is short and simple is that the geometries are
specified by <em>Signed Distance Functions</em>. These give the shortest
distance from any point in space to the boundary of the domain. The sign
is negative inside the region and positive outside. A simple example is
the unit circle in 2-D, which has the distance function <em>d=r-1</em>,
where <em>r</em> is the distance from the origin. For more complicated
geometries the distance function can be computed by interpolation between
values on a grid, a common representation for level set methods.
</p>

<p>
For the actual mesh generation, DistMesh uses the Delaunay triangulation
routine in MATLAB and tries to optimize the node locations by a force-based
smoothing procedure. The topology is regularly updated by Delaunay.
The boundary points are only allowed to move tangentially to the boundary
by projections using the distance function.
This iterative procedure typically results in very well-shaped meshes.
</p>

<p> Our aim with this code is simplicity, so that everyone can
understand the code and modify it according to their needs. The code
is not entirely robust (that is, it might not terminate and return a
well-shaped mesh), and it is relatively slow. However, our current
research shows that these issues can be resolved in an optimized C++
code, and we believe our simple MATLAB code is important for
demonstration of the underlying principles. </p>

<p>
To use the code, simply download it from below and run it from MATLAB.
For a quick demonstration, type "meshdemo2d" or "meshdemond".
For more details see the documentation.
</p>

<H3>Download</H3>
<p>
Download the archive below and unpack. Add this directory to your MATLAB
path, or make it the current directory.  The code contains some C++ files,
and binaries for 32/64-bit Windows, 64-bit Mac OS X, and 64-bit linux are
provided, as well as the source code.
</p>


<UL>
  <LI>
  <a href="distmesh.zip">distmesh.zip</A> Current version 1.1 - complete package (ZIP archive)
  </li>
  <LI>
  <a href="distmesh_v10.zip">distmesh_v10.zip</A> Original version 1.0 - complete package (ZIP archive)
  </li>
</UL>
<p>
DistMesh is distributed under the <a href="http://www.gnu.org/copyleft/gpl.html"> GNU GPL</a>;
see the <a href="copyright.html">License and Copyright</a> notice for more information.
</p>

<H3>Documentation</H3>

<ul>
  <li>
  P.-O. Persson, G. Strang, <b>A Simple Mesh Generator in MATLAB</b>.<br>
  <em>SIAM Review</em>, Volume 46 (2), pp. 329-345, June 2004 (<a href="persson04mesh.pdf">PDF</a>)
  </li>
  <li>
  P.-O. Persson, <b>Mesh Generation for Implicit Geometries</b>.<br>
  <em>Ph.D. thesis, Department of Mathematics, MIT</em>, Dec 2004 (<a href="http://persson.berkeley.edu/thesis/persson-thesis-color.pdf">PDF</a>)
  </li>

  <li>
  <a href="funcref.html">Function reference</a>
  </li>
</ul>

<H3>Gallery</H3>
<UL>
  <LI><A 
  href="gallery_images.html">Images</A> 
  <LI><A 
  href="gallery_movies.html">Movies</A> 
  <LI><A 
  href="gallery_java.html">Interactive 
  Java Applets</A> </LI></UL>

<UL>
  <LI><A 
  href="http://persson.berkeley.edu/thesis">Applications and Moving Meshes</A> 
  </li>
</ul>

<H3>Examples</H3>

<pre>
% Example: (Uniform Mesh on Unit Circle)
    fd=@(p) sqrt(sum(p.^2,2))-1;
    [p,t]=distmesh2d(fd,@huniform,0.2,[-1,-1;1,1],[]);
</pre>
<img src="ex01.png" hspace=80 vspace=10>

<pre>
% Example: (Rectangle with circular hole, refined at circle boundary)
    fd=@(p) ddiff(drectangle(p,-1,1,-1,1),dcircle(p,0,0,0.5));
    fh=@(p) 0.05+0.3*dcircle(p,0,0,0.5);
    [p,t]=distmesh2d(fd,fh,0.05,[-1,-1;1,1],[-1,-1;-1,1;1,-1;1,1]);
</pre>
<img src="ex02.png" hspace=80 vspace=10>

<pre>
% Example: (Polygon)
    pv=[-0.4 -0.5;0.4 -0.2;0.4 -0.7;1.5 -0.4;0.9 0.1;
        1.6 0.8;0.5 0.5;0.2 1;0.1 0.4;-0.7 0.7;-0.4 -0.5];
    [p,t]=distmesh2d(@dpoly,@huniform,0.1,[-1,-1; 2,1],pv,pv);
</pre>
<img src="ex03.png" hspace=80 vspace=10>

<pre>
% Example: (Ellipse)
    fd=@(p) p(:,1).^2/2^2+p(:,2).^2/1^2-1;
    [p,t]=distmesh2d(fd,@huniform,0.2,[-2,-1;2,1],[]);
</pre>
<img src="ex04.png" hspace=80 vspace=10>

<pre>
% Example: (Square, with size function point and line sources)
    fd=@(p) drectangle(p,0,1,0,1);
    fh=@(p) min(min(0.01+0.3*abs(dcircle(p,0,0,0)), ...
                 0.025+0.3*abs(dpoly(p,[0.3,0.7; 0.7,0.5]))),0.15);
    [p,t]=distmesh2d(fd,fh,0.01,[0,0;1,1],[0,0;1,0;0,1;1,1]);
</pre>
<img src="ex05.png" hspace=80 vspace=10>

<pre>
% Example: (NACA0012 airfoil)
    hlead=0.01; htrail=0.04; hmax=2; circx=2; circr=4;
    a=.12/.2*[0.2969,-0.1260,-0.3516,0.2843,-0.1036];

    fd=@(p) ddiff(dcircle(p,circx,0,circr),(abs(p(:,2))-polyval([a(5:-1:2),0],p(:,1))).^2-a(1)^2*p(:,1));
    fh=@(p) min(min(hlead+0.3*dcircle(p,0,0,0),htrail+0.3*dcircle(p,1,0,0)),hmax);

    fixx=1-htrail*cumsum(1.3.^(0:4)');
    fixy=a(1)*sqrt(fixx)+polyval([a(5:-1:2),0],fixx);
    fix=[[circx+[-1,1,0,0]*circr; 0,0,circr*[-1,1]]'; 0,0; 1,0; fixx,fixy; fixx,-fixy];
    box=[circx-circr,-circr; circx+circr,circr];
    h0=min([hlead,htrail,hmax]);

    [p,t]=distmesh2d(fd,fh,h0,box,fix);
</pre>
<img src="ex06.png" hspace=80 vspace=10>
<img src="ex06zoom.png" hspace=0 vspace=25>

<pre>
% Example: (Uniform Mesh on Unit Sphere)
    fd=@(p) dsphere(p,0,0,0,1);
    [p,t]=distmeshsurface(fd,@huniform,0.2,1.1*[-1,-1,-1;1,1,1]);
</pre>
<img src="ex07.png" hspace=80 vspace=10>

<pre>
% Example: (Graded Mesh on Unit Sphere)
    fd=@(p) dsphere(p,0,0,0,1);
    fh=@(p) 0.05+0.5*dsphere(p,0,0,1,0);
    [p,t]=distmeshsurface(fd,fh,0.15,1.1*[-1,-1,-1;1,1,1]);
</pre>
<img src="ex08.png" hspace=80 vspace=10>

<pre>
% Example: (Uniform Mesh on Torus)
    fd=@(p) (sum(p.^2,2)+.8^2-.2^2).^2-4*.8^2*(p(:,1).^2+p(:,2).^2);
    [p,t]=distmeshsurface(fd,@huniform,0.1,[-1.1,-1.1,-.25;1.1,1.1,.25]);
</pre>
<img src="ex09.png" hspace=80 vspace=10>

<pre>
% Example: (Uniform Mesh on Ellipsoid)
    fd=@(p) p(:,1).^2/4+p(:,2).^2/1+p(:,3).^2/1.5^2-1;
    [p,t]=distmeshsurface(fd,@huniform,0.2,[-2.1,-1.1,-1.6; 2.1,1.1,1.6]);
</pre>
<img src="ex10.png" hspace=80 vspace=10>

<HR>

<ADDRESS>Per-Olof Persson <BR>Department of Mathematics, UC Berkeley
<BR>persson@berkeley.edu </ADDRESS>

</td>

<td class=side width=120>
</td>
  
</tr>
</table>

</BODY>
</HTML>
